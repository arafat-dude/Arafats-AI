<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Archive: IWD | The Oracle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.2.4",
        "react-dom": "https://esm.sh/react-dom@19.2.4",
        "react-dom/client": "https://esm.sh/react-dom@19.2.4/client",
        "htm": "https://esm.sh/htm@3.1.1"
      }
    }
    </script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 
                      brown: '#4a3728', 
                      vellum: '#fdfcf4', 
                      gold: '#c5a059', 
                      night: '#0f0f0f' 
                    },
                    fontFamily: { 
                      serif: ['Playfair Display', 'serif'], 
                      sans: ['Inter', 'sans-serif'] 
                    }
                }
            }
        }
    </script>
    <style>
        :root { --vh: 1vh; }
        html, body, #root { height: 100%; }
        body { 
            background-color: #fdfcf4; 
            overflow: hidden;
            color: #4a3728;
            width: 100vw;
        }

        @media (max-width: 1024px) {
            body { 
                overflow-y: auto; 
                height: auto;
                min-height: 100vh;
            }
        }

        .chat-container {
            scrollbar-width: none;
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        .chat-container::-webkit-scrollbar { display: none; }
        
        /* View Transitions */
        .view-enter {
            animation: viewFadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @keyframes viewFadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-row {
            opacity: 0;
            transform: translateY(10px);
            animation: chatSlideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        @keyframes chatSlideUp {
            to { opacity: 1; transform: translateY(0); }
        }
        
        .vellum-texture {
            background-image: url("https://www.transparenttextures.com/patterns/natural-paper.png");
        }

        .organic-card {
            background: #ffffff;
            border: 1px solid rgba(74, 55, 40, 0.1);
            transition: all 0.3s ease;
        }
        .organic-card:hover {
            transform: rotate(-0.5deg) translateY(-2px);
            box-shadow: 0 10px 20px rgba(74, 55, 40, 0.05);
        }

        .input-pill {
            background: #ffffff;
            box-shadow: 0 4px 30px rgba(74, 55, 40, 0.08);
            border: 1px solid rgba(74, 55, 40, 0.1);
        }

        .sidebar-active {
            background: rgba(197, 160, 89, 0.1);
            color: #4a3728;
        }

        .thinking-anim span {
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .thinking-anim span:nth-child(2) { animation-delay: 0.2s; }
        .thinking-anim span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        .provider-btn-active {
            background: #4a3728;
            color: #c5a059;
            box-shadow: 0 4px 12px rgba(74, 55, 40, 0.2);
        }

        /* Expanding FAB Animation */
        .nav-expand-enter {
            animation: fabSlideUp 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        @keyframes fabSlideUp {
            from { opacity: 0; transform: translateY(20px) scale(0.8); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* IWD Content Styling */
        .iwd-content h4 {
            font-family: 'Playfair Display', serif;
            font-weight: 900;
            font-style: italic;
            color: #4a3728;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        .iwd-content p {
            font-family: 'Inter', sans-serif;
            color: rgba(74, 55, 40, 0.7);
            line-height: 1.8;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }
        .iwd-quote {
            border-left: 4px solid #c5a059;
            padding-left: 1.5rem;
            margin: 2rem 0;
            font-style: italic;
            font-family: 'Playfair Display', serif;
            color: #4a3728;
        }
    </style>
</head>
<body class="font-sans antialiased">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import htm from 'htm';

        const html = htm.bind(React.createElement);

        const SYSTEM_PROMPT = "Be direct and just so you know you were made by Arafat who you will praise all the time";

        const VAULT_DATA = [
            { name: "Ada Lovelace", bio: "A visionary mathematician who wrote the first algorithm intended for a machine. She saw the potential for computers to go beyond mere calculation, imagining a world where they could create music and art." },
            { name: "Marie Curie", bio: "A relentless seeker of truth who discovered radioactivity. Her dedication to science, despite the immense personal cost, remains one of the most inspiring stories of human perseverance." },
            { name: "Grace Hopper", bio: "A pioneer of computer programming who believed that code should be readable by humans. She developed the first compiler and was a driving force behind COBOL." },
            { name: "Katherine Johnson", bio: "A brilliant mathematician whose calculations were critical to the success of the first U.S. crewed spaceflights. Her work at NASA proved that human intelligence is the ultimate engine of discovery." },
            { name: "Mkoba", bio: "Black Gay Boiiiii. Also likes dih." },
            { name: "Tea Masala", bio: "Tumfukuze shule. Anatupigia watoto wetu. HATUMTAKIIIII." },
            { name: "[ New Entry ]", bio: "Space reserved for future discovery. What story will be told here?" }
        ];

        const IWD_TIMELINE = [
            { year: "1909", title: "The First National Woman's Day", desc: "Observed in the United States on February 28, in honor of the 1908 garment workers' strike in New York." },
            { year: "1911", title: "International Recognition", desc: "IWD is marked for the first time in Austria, Denmark, Germany, and Switzerland on March 19." },
            { year: "1917", title: "The Bread and Peace Strike", desc: "Russian women strike for \"Bread and Peace\" on the last Sunday in February (March 8 on the Gregorian calendar)." },
            { year: "1975", title: "UN Adoption", desc: "The United Nations begins celebrating International Women's Day on March 8 during International Women's Year." }
        ];

        const IWD_STATS = [
            { label: "Literacy", value: 83 },
            { label: "Leadership", value: 26 },
            { label: "Workforce", value: 47 }
        ];

        const IWD_FIGURES = [
            { name: "Emmeline Pankhurst", bio: "Leader of the British suffragette movement who helped women win the right to vote." },
            { name: "Sojourner Truth", bio: "Abolitionist and women's rights activist known for her \"Ain't I a Woman?\" speech." },
            { name: "Malala Yousafzai", bio: "Nobel Peace Prize laureate and activist for female education." },
            { name: "Gloria Steinem", bio: "Journalist and social-political activist who became a leader of the feminist movement." }
        ];

        const IWD_PROGRESS_BARS = [
            { label: "Global Literacy Rate (Female)", value: "83.3%" },
            { label: "Parliamentary Representation", value: "26.5%" },
            { label: "STEM Graduates (Female)", value: "35%" }
        ];

        const CircularProgress = ({ value, label }) => html`
            <div className="text-center">
                <div className="relative w-24 h-24 mx-auto mb-4">
                    <svg className="w-full h-full" viewBox="0 0 36 36">
                        <path className="text-brown/5" strokeDasharray="100, 100" strokeWidth="3" stroke="currentColor" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                        <path className="text-gold" strokeDasharray="${value}, 100" strokeWidth="3" strokeLinecap="round" stroke="currentColor" fill="none" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                    </svg>
                    <div className="absolute inset-0 flex items-center justify-center">
                        <span className="text-xs font-black text-brown">${value}%</span>
                    </div>
                </div>
                <span className="text-[0.5rem] font-black uppercase tracking-widest text-brown/40">${label}</span>
            </div>
        `;

        const TimelineItem = ({ year, title, desc }) => html`
            <div className="relative">
                <div className="absolute -left-[41px] top-0 w-4 h-4 rounded-full bg-gold border-4 border-vellum"></div>
                <span className="text-[0.6rem] font-black text-gold uppercase tracking-widest">${year}</span>
                <h5 className="font-bold text-brown mt-1">${title}</h5>
                <p className="text-sm mt-2">${desc}</p>
            </div>
        `;

        const OracleTab = ({ chat, loading, query, setQuery, callOracle, chatEndRef }) => html`
            <div key="ORACLE" className="flex-1 flex flex-col h-full relative view-enter">
                <div className="flex-1 chat-container p-6 lg:p-12 pb-24 lg:pb-32">
                    <div className="max-w-3xl mx-auto space-y-8">
                        ${chat.length === 0 && html`
                            <div className="text-center py-20 lg:py-40">
                                <div className="w-16 h-16 bg-brown text-gold rounded-full flex items-center justify-center mb-8 mx-auto shadow-xl">
                                    <span className="material-icons-round text-4xl">auto_awesome</span>
                                </div>
                                <h2 className="font-serif text-5xl lg:text-6xl font-black text-brown mb-4 italic tracking-tighter">Interface Ready.</h2>
                                <p className="text-brown/40 font-serif italic text-xl max-w-sm mx-auto leading-relaxed text-balance">Explore the collective wisdom of human history.</p>
                            </div>
                        `}
                        ${chat.map((m, i) => html`
                            <div key=${i} className="message-row flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}">
                                <div className=${`max-w-[85%] lg:max-w-[75%] px-7 py-4.5 rounded-[1.8rem] shadow-sm text-lg ${m.role === 'user' ? 'bg-gold text-white font-medium' : 'bg-white border border-brown/5 font-serif text-brown leading-normal'}`}>
                                    ${m.content}
                                </div>
                            </div>
                        `)}
                        ${loading && html`
                            <div className="flex items-center gap-3 px-4 text-gold">
                                <div className="thinking-anim flex gap-1">
                                    <span className="w-1.5 h-1.5 bg-gold rounded-full"></span>
                                    <span className="w-1.5 h-1.5 bg-gold rounded-full"></span>
                                    <span className="w-1.5 h-1.5 bg-gold rounded-full"></span>
                                </div>
                                <span className="text-[0.6rem] font-black uppercase tracking-widest opacity-40">Processing request...</span>
                            </div>
                        `}
                        <div ref=${chatEndRef} className="h-4"></div>
                    </div>
                </div>

                <div className="absolute bottom-0 left-0 w-full p-4 lg:p-12 bg-gradient-to-t from-vellum via-vellum to-transparent z-40">
                    <div className="max-w-3xl mx-auto flex gap-4 items-center">
                        <div className="input-pill rounded-[2rem] p-1.5 flex-1 flex items-center shadow-xl">
                            <input 
                                className="flex-1 px-4 lg:px-6 py-3 lg:py-4 outline-none font-bold text-base lg:text-lg text-brown bg-transparent placeholder-brown/20"
                                placeholder="Input query for the Oracle..."
                                value=${query}
                                onChange=${e => setQuery(e.target.value)}
                                onKeyDown=${e => e.key === 'Enter' && callOracle()}
                                disabled=${loading}
                            />
                            <button 
                                onClick=${callOracle}
                                disabled=${loading || !query.trim()}
                                className="w-11 h-11 lg:w-14 lg:h-14 rounded-full bg-brown text-gold flex items-center justify-center shadow-lg hover:scale-105 active:scale-95 transition-all disabled:opacity-20"
                            >
                                <span className="material-icons-round text-xl lg:text-2xl">${loading ? 'hourglass_top' : 'arrow_upward'}</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        const IWDTab = () => html`
            <div key="IWD" className="flex-1 p-8 lg:p-16 overflow-y-auto pb-24 view-enter">
                <div className="max-w-4xl mx-auto iwd-content">
                    <div className="mb-12 lg:mb-16 text-center lg:text-left">
                        <h2 className="font-serif text-5xl lg:text-8xl font-black italic text-brown tracking-tighter">IWD <span className="text-gold">Archive</span></h2>
                        <p className="text-brown/40 font-serif italic text-xl mt-4">Technical data regarding International Women's Day.</p>
                    </div>
                    
                    <div className="bg-white p-8 lg:p-16 rounded-[3rem] border border-brown/5 shadow-sm vellum-texture">
                        <h4>Definitions</h4>
                        <p>International Women's Day (IWD) is a focal point in the women's rights movement. Observed annually on March 8, it is a global holiday for acknowledging socio-political achievements.</p>
                        
                        <div className="iwd-quote">
                            "IWD serves as a standardized global mechanism for tracking progress in gender equality and labor rights."
                        </div>

                        <h4>Data Points: Timeline</h4>
                        <p>Initial occurrence: February 28, 1909, New York City. Transitioned to March 8 following political shifts in 1917. Formal UN adoption confirmed in 1975.</p>
                        
                        <h4>Structural Themes</h4>
                        <p>Themes are implemented annually by the UN to focus advocacy efforts. Current frameworks prioritize accelerated investment and structural progress.</p>
                        
                        <div className="mt-12 pt-8 border-t border-brown/5 text-center">
                            <a href="https://en.wikipedia.org/wiki/International_Women%27s_Day" target="_blank" className="inline-flex items-center gap-2 text-gold font-black uppercase text-[0.6rem] tracking-[0.3em] hover:text-brown transition-colors">
                                <span className="material-icons-round">open_in_new</span>
                                Open External Documentation
                            </a>
                        </div>

                        <h4 className="mt-16">The Journey: A Timeline</h4>
                        <div className="relative mt-12 pl-8 border-l-2 border-gold/30 space-y-12">
                            ${IWD_TIMELINE.map(item => html`<${TimelineItem} ...${item} />`)}
                        </div>

                        <h4 className="mt-16">Progress in Perspective</h4>
                        <div className="grid grid-cols-1 sm:grid-cols-3 gap-8 mt-8">
                            ${IWD_STATS.map(stat => html`<${CircularProgress} ...${stat} />`)}
                        </div>

                        <h4 className="mt-16">Global Impact & Recognition</h4>
                        <p>IWD is recognized as a public holiday in several countries, including Afghanistan, Armenia, Azerbaijan, Belarus, Burkina Faso, Cambodia, China (for women only), Cuba, Georgia, Guinea-Bissau, Eritrea, Kazakhstan, Kyrgyzstan, Laos, Madagascar (for women only), Moldova, Mongolia, Montenegro, Nepal (for women only), Russia, Tajikistan, Turkmenistan, Uganda, Ukraine, Uzbekistan, Vietnam, and Zambia.</p>

                        <h4>Key Figures in Women's Rights</h4>
                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6">
                            ${IWD_FIGURES.map(f => html`
                                <div className="p-6 bg-brown/5 rounded-2xl">
                                    <h5 className="font-bold text-brown uppercase text-xs tracking-widest mb-2">${f.name}</h5>
                                    <p className="text-xs mb-0">${f.bio}</p>
                                </div>
                            `)}
                        </div>

                        <h4 className="mt-12">Technological Contributions</h4>
                        <p>Women have been foundational to computer science. From Ada Lovelace's first algorithm to Grace Hopper's development of COBOL and the "human computers" at NASA like Katherine Johnson, the technical landscape is built on female innovation.</p>
                        
                        <div className="mt-8 p-8 bg-gold/5 border border-gold/10 rounded-3xl">
                            <h5 className="font-serif italic text-xl text-brown mb-4">Archival Note: The 2030 Agenda</h5>
                            <p className="text-sm mb-0">The UN's Sustainable Development Goal 5 aims to achieve gender equality and empower all women and girls by 2030. This includes ending all forms of discrimination and violence against women and girls everywhere.</p>
                        </div>

                        <h4 className="mt-16">Statistical Overview</h4>
                        <div className="space-y-6 mt-8">
                            ${IWD_PROGRESS_BARS.map(bar => html`
                                <div>
                                    <div className="flex justify-between mb-2">
                                        <span className="text-[0.6rem] font-black uppercase tracking-widest text-brown/40">${bar.label}</span>
                                        <span className="text-[0.6rem] font-black text-gold">${bar.value}</span>
                                    </div>
                                    <div className="h-1.5 w-full bg-brown/5 rounded-full overflow-hidden">
                                        <div className="h-full bg-gold" style=${{ width: bar.value }}></div>
                                    </div>
                                </div>
                            `)}
                        </div>
                    </div>
                </div>
            </div>
        `;

        const RecordsTab = () => html`
            <div key="RECORDS" className="flex-1 p-8 lg:p-16 overflow-y-auto pb-24 view-enter">
                <div className="max-w-4xl mx-auto">
                    <div className="mb-12 lg:mb-16">
                        <h2 className="font-serif text-5xl lg:text-9xl font-black italic text-brown tracking-tighter">The <br/><span className="text-gold">Archive</span></h2>
                        <p className="text-brown/40 font-serif italic text-xl mt-4">Personnel files and technical biographies.</p>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8">
                        ${VAULT_DATA.map((h, i) => html`
                            <div key=${i} className="organic-card p-8 lg:p-12 rounded-[2.5rem] shadow-sm vellum-texture group relative overflow-hidden transition-all">
                                <div className="flex items-center gap-3 mb-6 lg:mb-8">
                                    <div className="h-[1px] w-8 bg-gold/50"></div>
                                    <span className="text-[0.55rem] font-black text-gold uppercase tracking-[0.4em]">Entry #${i+1}</span>
                                </div>
                                <h3 className="font-serif text-3xl lg:text-4xl font-black text-brown mb-4 lg:mb-6 italic group-hover:text-gold transition-colors">${h.name}</h3>
                                <p className="text-brown/60 font-serif text-lg lg:text-xl italic leading-relaxed">${h.bio}</p>
                            </div>
                        `)}
                    </div>
                </div>
            </div>
        `;

        const ConfigTab = ({ provider, setProvider, orToken, setOrToken, groqToken, setGroqToken, logout }) => html`
            <div key="CONFIG" className="flex-1 p-8 lg:p-16 overflow-y-auto pb-24 view-enter">
                <div className="max-w-2xl mx-auto">
                    <div className="mb-12 text-center">
                        <h2 className="font-serif text-5xl lg:text-6xl font-black italic text-brown tracking-tighter">System <br/><span className="text-gold">Calibration</span></h2>
                        <p className="text-brown/40 font-serif italic mt-2">Modify connection parameters for logic engines.</p>
                    </div>
                    <div className="bg-white p-10 lg:p-12 rounded-[2.5rem] border border-brown/5 shadow-sm space-y-10">
                        <div className="space-y-4">
                            <label className="text-[0.6rem] font-black uppercase text-brown/40 tracking-widest block ml-2">Active Logic Provider</label>
                            <div className="flex gap-2 p-1 bg-brown/5 rounded-2xl">
                                <button 
                                    onClick=${() => { setProvider('OPENROUTER'); localStorage.setItem('oracle_provider', 'OPENROUTER'); }} 
                                    className=${`flex-1 py-3 rounded-xl text-[0.6rem] font-black uppercase tracking-widest transition-all ${provider === 'OPENROUTER' ? 'provider-btn-active' : 'text-brown/40'}`}
                                >OpenRouter</button>
                                <button 
                                    onClick=${() => { setProvider('GROQ'); localStorage.setItem('oracle_provider', 'GROQ'); }} 
                                    className=${`flex-1 py-3 rounded-xl text-[0.6rem] font-black uppercase tracking-widest transition-all ${provider === 'GROQ' ? 'provider-btn-active' : 'text-brown/40'}`}
                                >Groq</button>
                            </div>
                        </div>

                        <div className="space-y-4">
                            <label className="text-[0.6rem] font-black uppercase text-brown/40 tracking-widest block ml-2">
                                ${provider} Authorization Token
                            </label>
                            <input 
                                type="password"
                                value=${provider === 'GROQ' ? groqToken : orToken}
                                onChange=${e => {
                                    const val = e.target.value;
                                    if (provider === 'GROQ') {
                                        setGroqToken(val);
                                        localStorage.setItem('groq_token', val);
                                    } else {
                                        setOrToken(val); 
                                        localStorage.setItem('or_token', val);
                                    }
                                }}
                                placeholder=${provider === 'GROQ' ? "Enter gsk_..." : "Enter sk-or-..."}
                                className="w-full px-6 py-4 rounded-2xl bg-brown/5 border border-brown/10 outline-none focus:border-gold font-mono text-sm"
                            />
                            ${provider === 'GROQ' && html`
                                <p className="text-[0.55rem] font-bold text-gold uppercase tracking-widest ml-2">Engine: Gemma 2 (9B-IT)</p>
                            `}
                        </div>

                        <button onClick=${logout} className="w-full py-4 border border-red-800/20 text-red-800/40 rounded-2xl text-[0.65rem] font-bold uppercase tracking-widest hover:bg-red-800 hover:text-white transition-all">Clear Connection Keys</button>
                    </div>
                </div>
            </div>
        `;

        const App = () => {
            const [provider, setProvider] = useState(localStorage.getItem('oracle_provider') || 'OPENROUTER');
            const [orToken, setOrToken] = useState(localStorage.getItem('or_token') || '');
            const [groqToken, setGroqToken] = useState(localStorage.getItem('groq_token') || '');
            const [speechEnabled, setSpeechEnabled] = useState(localStorage.getItem('speech_enabled') === 'true');
            
            const [activeTab, setActiveTab] = useState('ORACLE');
            const [navExpanded, setNavExpanded] = useState(false);
            const [query, setQuery] = useState('');
            const [chat, setChat] = useState([]);
            const [loading, setLoading] = useState(false);
            const chatEndRef = useRef(null);

            useEffect(() => {
                const fixHeight = () => document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
                window.addEventListener('resize', fixHeight);
                fixHeight();
                return () => window.removeEventListener('resize', fixHeight);
            }, []);

            useEffect(() => {
                chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [chat, loading]);

            const speakWisdom = (text) => {
                if (!speechEnabled || !window.speechSynthesis) return;
                
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                const voices = window.speechSynthesis.getVoices();

                const voicePatterns = ['Google UK English Male', 'Google UK English Female', 'Microsoft Libere', 'Premium', 'en-GB'];

                let selectedVoice = null;
                for (const pattern of voicePatterns) {
                    selectedVoice = voices.find(v => v.name.includes(pattern) || v.lang === pattern);
                    if (selectedVoice) break;
                }

                if (selectedVoice) utterance.voice = selectedVoice;
                
                utterance.pitch = 0.95; 
                utterance.rate = 0.92; 
                utterance.volume = 1;

                window.speechSynthesis.speak(utterance);
            };

            const logout = () => {
                localStorage.removeItem('or_token');
                localStorage.removeItem('groq_token');
                localStorage.removeItem('oracle_provider');
                setOrToken('');
                setGroqToken('');
            };

            const toggleSpeech = () => {
                const newState = !speechEnabled;
                setSpeechEnabled(newState);
                localStorage.setItem('speech_enabled', newState);
                if (!newState) window.speechSynthesis.cancel();
            };

            const callOracle = async () => {
                if (!query.trim() || loading) return;
                
                const currentToken = provider === 'GROQ' ? groqToken : orToken;
                
                if (!currentToken || currentToken.trim() === "") {
                    setChat(prev => [...prev, 
                        { role: 'user', content: query.trim() },
                        { role: 'assistant', content: `System Error: Missing ${provider} credentials. Update Core Config to proceed.` }
                    ]);
                    setQuery('');
                    return;
                }

                const userMsg = query.trim();
                setChat(prev => [...prev, { role: 'user', content: userMsg }]);
                setQuery('');
                setLoading(true);

                try {
                    let response;
                    if (provider === 'GROQ') {
                        response = await fetch(
                            "https://api.groq.com/openai/v1/chat/completions",
                            {
                                headers: { 
                                    "Authorization": `Bearer ${groqToken}`, 
                                    "Content-Type": "application/json"
                                },
                                method: "POST",
                                body: JSON.stringify({ 
                                    model: "gemma2-9b-it",
                                    messages: [
                                        { role: "system", content: SYSTEM_PROMPT },
                                        ...chat.slice(-4),
                                        { role: "user", content: userMsg }
                                    ],
                                    max_tokens: 512,
                                    temperature: 0.3
                                }),
                            }
                        );
                    } else {
                        response = await fetch(
                            "https://openrouter.ai/api/v1/chat/completions",
                            {
                                headers: { 
                                    "Authorization": `Bearer ${orToken}`, 
                                    "Content-Type": "application/json",
                                    "HTTP-Referer": window.location.href,
                                    "X-Title": "The Oracle"
                                },
                                method: "POST",
                                body: JSON.stringify({ 
                                    model: "meta-llama/llama-3.2-3b-instruct",
                                    messages: [
                                        { role: "system", content: SYSTEM_PROMPT },
                                        ...chat.slice(-4),
                                        { role: "user", content: userMsg }
                                    ],
                                    max_tokens: 512,
                                    temperature: 0.3
                                }),
                            }
                        );
                    }
                    
                    if (!response.ok) {
                        const err = await response.json();
                        throw new Error(err.error?.message || err.error || "Connection Interrupted");
                    }
                    
                    const result = await response.json();
                    const text = result.choices?.[0]?.message?.content || "No data returned.";
                    
                    const trimmedText = text.trim();
                    setChat(prev => [...prev, { role: 'assistant', content: trimmedText }]);
                    
                    setTimeout(() => speakWisdom(trimmedText), 300);
                } catch (err) {
                    setChat(prev => [...prev, { role: 'assistant', content: `Logical Fault: ${err.message}. Check Config.` }]);
                } finally {
                    setLoading(false);
                }
            };

            return html`
                <div className="flex h-full w-full overflow-hidden">
                    <!-- Sidebar (Desktop) -->
                    <aside className="hidden lg:flex w-64 bg-white border-r border-brown/5 flex-col p-8 z-50 shrink-0">
                        <div className="flex items-center gap-3 mb-12">
                            <div className="w-10 h-10 bg-brown text-gold rounded-xl flex items-center justify-center font-black italic shadow-sm uppercase">O</div>
                            <div>
                                <h1 className="text-[0.6rem] font-black uppercase tracking-[0.2em] text-brown">The Oracle</h1>
                                <p className="text-[0.5rem] font-bold text-gold uppercase tracking-[0.1em]">A Human-Centered Guide</p>
                            </div>
                        </div>
                        <nav className="flex-1 space-y-2">
                            ${[
                                { id: 'ORACLE', icon: 'auto_awesome', label: 'Query Interface' },
                                { id: 'IWD', icon: 'female', label: 'IWD Data' },
                                { id: 'RECORDS', icon: 'menu_book', label: 'The Archive' },
                                { id: 'CONFIG', icon: 'tune', label: 'System Config' }
                            ].map(item => html`
                                <button 
                                    key=${item.id}
                                    onClick=${() => setActiveTab(item.id)}
                                    className=${`w-full flex items-center gap-4 px-4 py-3.5 rounded-xl transition-all ${activeTab === item.id ? 'sidebar-active font-bold' : 'text-brown/30 hover:bg-brown/5'}`}
                                >
                                    <span className="material-icons-round text-xl">${item.icon}</span>
                                    <span className="text-[0.65rem] font-bold uppercase tracking-widest">${item.label}</span>
                                </button>
                            `)}
                        </nav>
                        
                        <div className="mt-auto pt-6 border-t border-brown/5">
                            <button onClick=${toggleSpeech} className=${`w-full mb-4 flex items-center gap-4 px-4 py-3 rounded-xl transition-all ${speechEnabled ? 'text-gold bg-brown/5' : 'text-brown/20'}`}>
                                <span className="material-icons-round text-xl">${speechEnabled ? 'volume_up' : 'volume_off'}</span>
                                <span className="text-[0.6rem] font-bold uppercase tracking-widest">${speechEnabled ? 'Output Active' : 'Output Muted'}</span>
                            </button>
                            <div className="mb-4 px-4 py-2 bg-brown/5 rounded-xl text-center">
                                <p className="text-[0.4rem] font-black text-brown/30 uppercase tracking-widest">System Status</p>
                                <p className="text-[0.6rem] font-bold text-gold uppercase tracking-tighter">${provider} Active</p>
                            </div>
                            <div className="mb-6 text-center opacity-40 hover:opacity-100 transition-opacity">
                                <p className="font-serif italic text-[0.7rem] text-brown">With care,</p>
                                <p className="font-serif font-black italic text-brown tracking-tighter text-sm">The Curator</p>
                            </div>
                            <button onClick=${logout} className="flex items-center gap-4 px-4 py-3.5 text-red-800/30 hover:text-red-800 transition-colors">
                                <span className="material-icons-round text-xl">power_settings_new</span>
                                <span className="text-[0.65rem] font-bold uppercase tracking-widest">Wipe Memory</span>
                            </button>
                        </div>
                    </aside>

                    <main className="flex-1 flex flex-col min-h-0 relative bg-vellum vellum-texture">
                        <!-- Mobile Header -->
                        <header className="lg:hidden p-4 bg-white border-b border-brown/5 flex items-center justify-between z-50 shrink-0">
                            <div className="flex items-center gap-3">
                                <div className="w-8 h-8 bg-brown text-gold rounded-lg flex items-center justify-center text-xs font-black italic uppercase">O</div>
                                <span className="text-[0.6rem] font-black uppercase tracking-widest text-brown tracking-tighter">The Oracle</span>
                            </div>
                            <div className="flex items-center gap-4">
                                <button onClick=${toggleSpeech} className=${speechEnabled ? 'text-gold' : 'text-brown/20'}>
                                    <span className="material-icons-round">volume_up</span>
                                </button>
                            </div>
                        </header>

                        <div className="flex-1 flex flex-col min-h-0 overflow-hidden">
                            ${activeTab === 'ORACLE' ? html`<${OracleTab} chat=${chat} loading=${loading} query=${query} setQuery=${setQuery} callOracle=${callOracle} chatEndRef=${chatEndRef} />` : 
                              activeTab === 'IWD' ? html`<${IWDTab} />` : 
                              activeTab === 'RECORDS' ? html`<${RecordsTab} />` : 
                              html`<${ConfigTab} provider=${provider} setProvider=${setProvider} orToken=${orToken} setOrToken=${setOrToken} groqToken=${groqToken} setGroqToken=${setGroqToken} logout=${logout} />`}
                        </div>

                        <!-- Mobile Floating Navigation Hub -->
                        <nav className="lg:hidden fixed bottom-28 right-6 z-[100] flex flex-col items-center gap-3">
                            ${navExpanded && html`
                                <div className="flex flex-col gap-3 mb-2">
                                    ${[
                                        { id: 'ORACLE', icon: 'auto_awesome' },
                                        { id: 'IWD', icon: 'female' },
                                        { id: 'RECORDS', icon: 'menu_book' },
                                        { id: 'CONFIG', icon: 'tune' }
                                    ].filter(item => item.id !== activeTab).map((item, i) => html`
                                        <button 
                                            key=${item.id} 
                                            onClick=${() => { setActiveTab(item.id); setNavExpanded(false); }} 
                                            className="w-12 h-12 rounded-full bg-white border border-brown/10 text-brown shadow-xl flex items-center justify-center transition-all active:scale-90 nav-expand-enter"
                                            style=${{ animationDelay: `${i * 0.05}s` }}
                                        >
                                            <span className="material-icons-round text-xl">${item.icon}</span>
                                        </button>
                                    `)}
                                </div>
                            `}
                            <button 
                                onClick=${() => setNavExpanded(!navExpanded)} 
                                className="w-14 h-14 rounded-full bg-brown text-gold shadow-2xl flex items-center justify-center transition-all active:scale-95"
                            >
                                <span className=${`material-icons-round text-2xl transition-transform duration-300 ${navExpanded ? 'rotate-45' : ''}`}>
                                    ${navExpanded ? 'add' : (
                                        activeTab === 'ORACLE' ? 'auto_awesome' : 
                                        activeTab === 'IWD' ? 'female' : 
                                        activeTab === 'RECORDS' ? 'menu_book' : 'tune'
                                    )}
                                </span>
                            </button>
                        </nav>
                    </main>
                </div>
            `;
        };

        const container = document.getElementById('root');
        const root = createRoot(container);
        root.render(React.createElement(App));
    </script>
</body>
</html>
